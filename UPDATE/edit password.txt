//ADMIN CONTROLLER
const changepassword = async (req,res,next)=>{
    try{
        const userType = req.session.userType;
        const newpassword = req.body.newpassword;
        const id = req.session.userId;
        console.log(body)
        console.log(userType,id,newpassword)
        const changedpassword = await Owner.changeuserpassword(userType,newpassword,id)
        console.log(changedpassword);
    }catch(error){
        next(error)
    }
}

//ADMIN MJS
export async function changeuserpassword(userType,newpassword,id){
  try{
    if (userType==='Admin'){
      await Owner.update({
        Password: newpassword
      },
      {
        where: {Owner_Id:id}
      }
      );
    } 
    else{
      await User.update({
        Password: newpassword
      },
      {
        where: {User_Id:id}
      }
      );
    }
  }catch(error){
    console.error("Error changing password:",error)
  }

}

//ROUTES DES STO PROFIL
router.get('/changepassword',
    UserController.checkIfAuthenticated,
    (req,res)=>{
        res.render('./change-password');
    }
)
router.post('/dochangepassword',
    UserController.checkIfAuthenticated,
    AdminController.changepassword,
    (req, res) => {
        res.render('./home',{message : "Changed passwords"});
    }
)